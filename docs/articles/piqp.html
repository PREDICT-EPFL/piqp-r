<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PIQR Solver Example • piqp</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="PIQR Solver Example">
<meta property="og:description" content="piqp">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">piqp</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/piqp.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/bnaras/piqp/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>PIQR Solver Example</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/bnaras/piqp/blob/HEAD/vignettes/piqp.Rmd" class="external-link"><code>vignettes/piqp.Rmd</code></a></small>
      <div class="hidden name"><code>piqp.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">1. Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>PIQP solves Quadratic Programs of the form</p>
<p><span class="math display">\[
\begin{aligned}
\min_{x} \quad &amp; \frac{1}{2} x^\top P x + c^\top x \\
\text {s.t.}\quad &amp; Ax=b, \\
&amp; Gx \leq h, \\
&amp; x_{lb} \leq x \leq x_{ub}
\end{aligned}
\]</span></p>
<p>with primal decision variables <span class="math inline">\(x \in
\mathbb{R}^n\)</span>, matrices <span class="math inline">\(P\in
\mathbb{S}_+^n\)</span>, <span class="math inline">\(A \in \mathbb{R}^{p
\times n}\)</span>, <span class="math inline">\(G \in \mathbb{R}^{m
\times n}\)</span>, and vectors <span class="math inline">\(c \in
\mathbb{R}^n\)</span>, <span class="math inline">\(b \in
\mathbb{R}^p\)</span>, <span class="math inline">\(h \in
\mathbb{R}^m\)</span>, <span class="math inline">\(x_{lb} \in
\mathbb{R}^n\)</span>, and <span class="math inline">\(x_{ub} \in
\mathbb{R}^n\)</span>.</p>
<p>Note that PIQP can handle infinite box constraints well, i.e. when
elements of <span class="math inline">\(x_{lb}\)</span> or <span class="math inline">\(x_{ub}\)</span> are <span class="math inline">\(-\infty\)</span> or <span class="math inline">\(\infty\)</span>, respectively. On the contrary,
infinite values in the general inequalities <span class="math inline">\(Gx \leq h = \pm \infty\)</span> can cause
problems, i.e., they are converted internally to <code>-1e30</code> and
<code>1e30</code>, respectively.</p>
</div>
<div class="section level2">
<h2 id="the-problem-solver-interface">2. The Problem Solver Interface<a class="anchor" aria-label="anchor" href="#the-problem-solver-interface"></a>
</h2>
<p>Consider:</p>
<p><span class="math display">\[
\begin{aligned}
\min_{x} \quad &amp; \frac{1}{2} x^\top \begin{bmatrix} 6 &amp; 0 \\ 0
&amp; 4 \end{bmatrix} x + \begin{bmatrix} -1 \\ -4 \end{bmatrix}^\top x
\\
\text {s.t.}\quad &amp; \begin{bmatrix} 1 &amp; -2 \end{bmatrix} x = 1,
\\
&amp; \begin{bmatrix} 1 &amp; -1 \\ 2 &amp; 0 \end{bmatrix} x \leq
\begin{bmatrix} 0.2 \\ -1 \end{bmatrix}, \\
&amp; -1 \leq x_1 \leq 1.
\end{aligned}
\]</span></p>
<p>The data for this problem can be specified as below.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">P</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">4</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">c</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">2</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">G</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">h</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">x_lb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="op">-</span><span class="cn">Inf</span><span class="op">)</span>  <span class="co">## 2 variables</span></span>
<span><span class="va">x_ub</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="cn">Inf</span><span class="op">)</span>    <span class="co">## 2 variables</span></span></code></pre></div>
<p>The problem can now be solved via a call to
<code><a href="../reference/solve_piqp.html">solve_piqp()</a></code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sol</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/solve_piqp.html">solve_piqp</a></span><span class="op">(</span><span class="va">P</span>, <span class="va">c</span>, <span class="va">A</span>, <span class="va">b</span>, <span class="va">G</span>, <span class="va">h</span>, x_lb <span class="op">=</span> <span class="va">x_lb</span>, x_ub <span class="op">=</span> <span class="va">x_ub</span>, backend <span class="op">=</span> <span class="st">"auto"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"(Solution status, description): = (%d, %s)\n"</span>,</span>
<span>            <span class="va">sol</span><span class="op">$</span><span class="va">status</span>, <span class="va">sol</span><span class="op">$</span><span class="va">info</span><span class="op">$</span><span class="va">status_desc</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; (Solution status, description): = (1, solved)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Objective: %f, solution: (x1, x2) = (%f, %f)\n"</span>, <span class="va">sol</span><span class="op">$</span><span class="va">info</span><span class="op">$</span><span class="va">primal_obj</span>, <span class="va">sol</span><span class="op">$</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">sol</span><span class="op">$</span><span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Objective: 6.160000, solution: (x1, x2) = (-0.600000, -0.800000)</span></span></code></pre></div>
<p><code>sol</code> contains many components as <code>str(sol)</code>
will display but the most important ones are:</p>
<ul>
<li>
<code>status</code> : 1 if all goes well (more below),</li>
<li>
<code>x</code> : solution vector</li>
<li>
<code>y</code> : dual solution for the equality constraints</li>
<li>
<code>z</code> : dual solution for the inequality constraints</li>
<li>
<code>z_lb</code> : dual solution of lower bound box
constraints</li>
<li>
<code>z_ub</code> : dual solution of upper bound box
constraints</li>
<li>
<code>info$status_desc</code>: a descriptive string of the
status</li>
<li>
<code>info$primal_pobj</code> : primal objective value</li>
<li>
<code>info$run_time</code> : total runtime, if asked for in settings
(see below).</li>
</ul>
<p>One can always construct the descriptive string for the status
using:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/status_description.html">status_description</a></span><span class="op">(</span><span class="va">sol</span><span class="op">$</span><span class="va">status</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Solver solved problem up to given tolerance."</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="the-solver-model-object">3. The Solver Model Object<a class="anchor" aria-label="anchor" href="#the-solver-model-object"></a>
</h2>
<p>Users who wish to solve QP problems will mostly use the
<code><a href="../reference/solve_piqp.html">solve_piqp()</a></code> function. Behind the scenes,
<code><a href="../reference/solve_piqp.html">solve_piqp()</a></code> creates a solver object and calls methods on
the object to obtain the solution. The solver object can be created
explitly using <code><a href="../reference/piqp.html">piqp()</a></code> and provides more elaborate
facilities for updating problem data. This can be very efficient when
one is solving the same kind of problem over and over.</p>
<p>The above problem could be solved using the solver model object
thus:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/piqp.html">piqp</a></span><span class="op">(</span><span class="va">P</span>, <span class="va">c</span>, <span class="va">A</span>, <span class="va">b</span>, <span class="va">G</span>, <span class="va">h</span>, x_lb <span class="op">=</span> <span class="va">x_lb</span>, x_ub <span class="op">=</span> <span class="va">x_ub</span><span class="op">)</span></span>
<span><span class="va">sol2</span> <span class="op">&lt;-</span> <span class="va">model</span><span class="op">$</span><span class="fu">solve</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="va">sol</span>, <span class="va">sol2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>Indeed, this is exactly what <code><a href="../reference/solve_piqp.html">solve_piqp()</a></code> does. But this
interface allows us to update the settings, the bounds, etc. and resolve
the same problem more efficiently.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span><span class="op">$</span><span class="fu">update</span><span class="op">(</span>x_lb <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">sol3</span> <span class="op">&lt;-</span> <span class="va">model</span><span class="op">$</span><span class="fu">solve</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"(Solution status, description): = (%d, %s)\n"</span>,</span>
<span>            <span class="va">sol3</span><span class="op">$</span><span class="va">status</span>, <span class="fu"><a href="../reference/status_description.html">status_description</a></span><span class="op">(</span><span class="va">sol3</span><span class="op">$</span><span class="va">status</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; (Solution status, description): = (-2, The problem is primal infeasible.)</span></span></code></pre></div>
<p>Setting the lower bounds made the problem infeasible.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Try to give an inappropriate b value</span></span>
<span><span class="va">model</span><span class="op">$</span><span class="fu">update</span><span class="op">(</span>b <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in model$update(b = c(5, 2)): Update parameters not match original problem dimensions</span></span></code></pre></div>
<p>The error message correctly indicates that b has wrong
dimensions.</p>
<p>The methods exposed by the model object can be seen in the
documentation for the object <code>piqp_model</code>.</p>
<p>For example, we could query the problem dimensions.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span><span class="op">$</span><span class="fu">get_dims</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; $n</span></span>
<span><span class="co">#&gt; [1] 2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $p</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $m</span></span>
<span><span class="co">#&gt; [1] 2</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="dense-and-sparse-interfaces">3. Dense and Sparse Interfaces<a class="anchor" aria-label="anchor" href="#dense-and-sparse-interfaces"></a>
</h2>
<p>PIQP supports dense and sparse problem formulations. For small and
dense problems the dense interface is preferred since vectorized
instructions and cache locality can be exploited more efficiently, but
for sparse problems the sparse interface and result in significant
speedups.</p>
<p>These interfaces can be requested explicitly via the
<code>backend</code> parameter which can take on any value among
<code>"dense"</code>, <code>"sparse"</code>, or <code>"auto"</code>, the
default. The last value will automatically switch to a sparse interface
if any of the supplied inputs (<span class="math inline">\(A\)</span>,
<span class="math inline">\(P\)</span>, or <span class="math inline">\(G\)</span>) is a sparse matrix; otherwise it uses
the dense interface.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sparse_sol</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/solve_piqp.html">solve_piqp</a></span><span class="op">(</span><span class="va">P</span>, <span class="va">c</span>, <span class="va">A</span>, <span class="va">b</span>, <span class="va">G</span>, <span class="va">h</span>, <span class="va">x_lb</span>, <span class="va">x_ub</span>, backend <span class="op">=</span> <span class="st">"sparse"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">sparse_sol</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 15</span></span>
<span><span class="co">#&gt;  $ status: int 1</span></span>
<span><span class="co">#&gt;  $ x     : num [1:2] -0.6 -0.8</span></span>
<span><span class="co">#&gt;  $ y     : num -11.8</span></span>
<span><span class="co">#&gt;  $ z     : num [1:2] 1.64e+01 1.01e-08</span></span>
<span><span class="co">#&gt;  $ z_lb  : num [1:2] 5.61e-10 0.00</span></span>
<span><span class="co">#&gt;  $ z_ub  : num [1:2] 3.2e-10 0.0</span></span>
<span><span class="co">#&gt;  $ s     : num [1:2] 5.19e-11 2.00e-01</span></span>
<span><span class="co">#&gt;  $ s_lb  : num [1:2] 0.4 Inf</span></span>
<span><span class="co">#&gt;  $ s_ub  : num [1:2] 1.6 Inf</span></span>
<span><span class="co">#&gt;  $ zeta  : num [1:2] -0.6 -0.8</span></span>
<span><span class="co">#&gt;  $ lambda: num -11.8</span></span>
<span><span class="co">#&gt;  $ nu    : num [1:2] 1.64e+01 1.01e-08</span></span>
<span><span class="co">#&gt;  $ nu_lb : num [1:2] 5.61e-10 0.00</span></span>
<span><span class="co">#&gt;  $ nu_ub : num [1:2] 3.2e-10 0.0</span></span>
<span><span class="co">#&gt;  $ info  :List of 24</span></span>
<span><span class="co">#&gt;   ..$ status_desc     : chr "solved"</span></span>
<span><span class="co">#&gt;   ..$ iter            : num 6</span></span>
<span><span class="co">#&gt;   ..$ rho             : num 1e-10</span></span>
<span><span class="co">#&gt;   ..$ delta           : num 1e-10</span></span>
<span><span class="co">#&gt;   ..$ mu              : num 9.01e-10</span></span>
<span><span class="co">#&gt;   ..$ sigma           : num 1e-06</span></span>
<span><span class="co">#&gt;   ..$ primal_step     : num 0.99</span></span>
<span><span class="co">#&gt;   ..$ dual_step       : num 0.99</span></span>
<span><span class="co">#&gt;   ..$ primal_inf      : num 4.44e-11</span></span>
<span><span class="co">#&gt;   ..$ primal_rel_inf  : num 1.6</span></span>
<span><span class="co">#&gt;   ..$ dual_inf        : num 8.11e-10</span></span>
<span><span class="co">#&gt;   ..$ dual_rel_inf    : num 7.2</span></span>
<span><span class="co">#&gt;   ..$ primal_obj      : num 6.16</span></span>
<span><span class="co">#&gt;   ..$ dual_obj        : num 6.16</span></span>
<span><span class="co">#&gt;   ..$ duality_gap     : num 3.88e-09</span></span>
<span><span class="co">#&gt;   ..$ duality_gap_rel : num 11.8</span></span>
<span><span class="co">#&gt;   ..$ factor_retires  : num 0</span></span>
<span><span class="co">#&gt;   ..$ reg_limit       : num 1e-10</span></span>
<span><span class="co">#&gt;   ..$ no_primal_update: num 0</span></span>
<span><span class="co">#&gt;   ..$ no_dual_update  : num 0</span></span>
<span><span class="co">#&gt;   ..$ setup_time      : num 0</span></span>
<span><span class="co">#&gt;   ..$ update_time     : num 0</span></span>
<span><span class="co">#&gt;   ..$ solve_time      : num 0</span></span>
<span><span class="co">#&gt;   ..$ run_time        : num 0</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="another-example">5. Another Example<a class="anchor" aria-label="anchor" href="#another-example"></a>
</h2>
<p>Suppose that we want to solve the following 2-dimensional quadratic
programming problem:</p>
<p><span class="math display">\[
\begin{array}{ll} \text{minimize} &amp;  3x_1^2 + 2x_2^2 - x_1 - 4x_2\\
\text{subject to} &amp;  -1 \leq x \leq 1, ~ x_1 = 2x_2
\end{array}
\]</span></p>
<p>Since the solver expects the objective in the form <span class="math inline">\(\frac{1}{2}x^\top P x + c^\top x\)</span>, we
define</p>
<p><span class="math display">\[
P = 2 \cdot \begin{bmatrix} 3 &amp; 0 \\ 0 &amp; 2\end{bmatrix}
\mbox{ and }
q = \begin{bmatrix} -1 \\ -4\end{bmatrix}.
\]</span></p>
<p>We have one equality constraint and box constraints. This leads to
the following straight-forward formulation.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">P</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">c</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">2</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">x_lb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.0</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">x_ub</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1.0</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">sol</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/solve_piqp.html">solve_piqp</a></span><span class="op">(</span>P <span class="op">=</span> <span class="va">P</span>, c <span class="op">=</span> <span class="va">c</span>, A <span class="op">=</span> <span class="va">A</span>, b <span class="op">=</span> <span class="va">b</span>, x_lb <span class="op">=</span> <span class="va">x_lb</span>, x_ub <span class="op">=</span> <span class="va">x_ub</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"(Solution status, description): = (%d, %s)\n"</span>,</span>
<span>            <span class="va">sol</span><span class="op">$</span><span class="va">status</span>, <span class="va">sol</span><span class="op">$</span><span class="va">info</span><span class="op">$</span><span class="va">status_desc</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; (Solution status, description): = (1, solved)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Objective: %f, solution: (x1, x2) = (%f, %f)\n"</span>, <span class="va">sol</span><span class="op">$</span><span class="va">info</span><span class="op">$</span><span class="va">primal_obj</span>, <span class="va">sol</span><span class="op">$</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">sol</span><span class="op">$</span><span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Objective: -0.642857, solution: (x1, x2) = (0.428571, 0.214286)</span></span></code></pre></div>
<p>But we can also choose to move the upper box constraints into the
inequalities.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">G</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">h</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">sol</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/solve_piqp.html">solve_piqp</a></span><span class="op">(</span>P <span class="op">=</span> <span class="va">P</span>, c <span class="op">=</span> <span class="va">c</span>, A <span class="op">=</span> <span class="va">A</span>, b <span class="op">=</span> <span class="va">b</span>, G <span class="op">=</span> <span class="va">G</span>, h <span class="op">=</span> <span class="va">h</span>,</span>
<span>                  x_lb <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span>, x_ub <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">Inf</span>, <span class="cn">Inf</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"(Solution status, description): = (%d, %s)\n"</span>,</span>
<span>            <span class="va">sol</span><span class="op">$</span><span class="va">status</span>, <span class="va">sol</span><span class="op">$</span><span class="va">info</span><span class="op">$</span><span class="va">status_desc</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; (Solution status, description): = (1, solved)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Objective: %f, solution: (x1, x2) = (%f, %f)\n"</span>, <span class="va">sol</span><span class="op">$</span><span class="va">info</span><span class="op">$</span><span class="va">primal_obj</span>, <span class="va">sol</span><span class="op">$</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">sol</span><span class="op">$</span><span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Objective: -0.642857, solution: (x1, x2) = (0.428571, 0.214286)</span></span></code></pre></div>
<p>Or we can move both of them into the inequalities.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">G</span> <span class="op">&lt;-</span> <span class="fu">Matrix</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/Matrix.html" class="external-link">Matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                    nrow <span class="op">=</span> <span class="fl">4</span>, sparse <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">h</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sol</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/solve_piqp.html">solve_piqp</a></span><span class="op">(</span>A <span class="op">=</span> <span class="va">A</span>, b <span class="op">=</span> <span class="va">b</span>, c <span class="op">=</span> <span class="va">c</span>, P <span class="op">=</span> <span class="va">P</span>, G <span class="op">=</span> <span class="va">G</span>, h <span class="op">=</span> <span class="va">h</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"(Solution status, description): = (%d, %s)\n"</span>,</span>
<span>            <span class="va">sol</span><span class="op">$</span><span class="va">status</span>, <span class="fu"><a href="../reference/status_description.html">status_description</a></span><span class="op">(</span><span class="va">sol</span><span class="op">$</span><span class="va">status</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; (Solution status, description): = (1, Solver solved problem up to given tolerance.)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Objective: %f, solution: (x1, x2) = (%f, %f)\n"</span>, <span class="va">sol</span><span class="op">$</span><span class="va">info</span><span class="op">$</span><span class="va">primal_obj</span>, <span class="va">sol</span><span class="op">$</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">sol</span><span class="op">$</span><span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Objective: -0.642857, solution: (x1, x2) = (0.428571, 0.214286)</span></span></code></pre></div>
<p>All of them will yield the same result.</p>
</div>
<div class="section level2">
<h2 id="solver-parameters">5. Solver parameters<a class="anchor" aria-label="anchor" href="#solver-parameters"></a>
</h2>
<p>PIQP has a number of parameters that control its behavior, including
verbosity, tolerances, etc.; see help on <code><a href="../reference/piqp_settings.html">piqp_settings()</a></code>.
As an example, in the last problem, we can reduce the number of
iterations.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/solve_piqp.html">solve_piqp</a></span><span class="op">(</span>P <span class="op">=</span> <span class="va">P</span>, c <span class="op">=</span> <span class="va">c</span>, A <span class="op">=</span> <span class="va">A</span>, b <span class="op">=</span> <span class="va">b</span>, G <span class="op">=</span> <span class="va">G</span>, h <span class="op">=</span> <span class="va">h</span>,</span>
<span>          settings <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>max_iter <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="co">## Reduced number of iterations</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"(Solution status, description): = (%d, %s)\n"</span>,</span>
<span>            <span class="va">s</span><span class="op">$</span><span class="va">status</span>, <span class="va">s</span><span class="op">$</span><span class="va">info</span><span class="op">$</span><span class="va">status_desc</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; (Solution status, description): = (-1, max iterations reached)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Objective: %f, solution: (x1, x2) = (%f, %f)\n"</span>, <span class="va">s</span><span class="op">$</span><span class="va">info</span><span class="op">$</span><span class="va">primal_obj</span>, <span class="va">s</span><span class="op">$</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">s</span><span class="op">$</span><span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Objective: -0.642857, solution: (x1, x2) = (0.428294, 0.214147)</span></span></code></pre></div>
<p>Note the different status, which should always be checked in
code.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://naras.su.domains/" class="external-link">Balasubramanian Narasimhan</a>, <a href="https://people.epfl.ch/roland.schwan" class="external-link">Roland Schwan</a>, <a href="https://people.epfl.ch/yuning.jiang" class="external-link">Yuning Jiang</a>, <a href="https://people.epfl.ch/daniel.kuhn" class="external-link">Daniel Kuhn</a>, <a href="https://people.epfl.ch/colin.jones" class="external-link">Colin N. Jones</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
